<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Realm Database | Realm Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mongodben.github.io/flutter-sdk-docs/realm-database"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Realm Database | Realm Docs"><meta data-react-helmet="true" name="description" content="Realm Database is a reactive, object-oriented, cross-platform, mobile"><meta data-react-helmet="true" property="og:description" content="Realm Database is a reactive, object-oriented, cross-platform, mobile"><link data-react-helmet="true" rel="icon" href="/flutter-sdk-docs/img/realm-logo.png"><link data-react-helmet="true" rel="canonical" href="https://mongodben.github.io/flutter-sdk-docs/realm-database"><link data-react-helmet="true" rel="alternate" href="https://mongodben.github.io/flutter-sdk-docs/realm-database" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mongodben.github.io/flutter-sdk-docs/realm-database" hreflang="x-default"><link rel="stylesheet" href="/flutter-sdk-docs/assets/css/styles.4eccaa6f.css">
<link rel="preload" href="/flutter-sdk-docs/assets/js/runtime~main.35287061.js" as="script">
<link rel="preload" href="/flutter-sdk-docs/assets/js/main.202f0466.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/flutter-sdk-docs/"><div class="navbar__logo"><img src="/flutter-sdk-docs/img/realm-logo.png" alt="Realm Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/flutter-sdk-docs/img/realm-logo.png" alt="Realm Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">MongoDB Realm Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mongodben/flutter-sdk-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter-sdk-docs/">Flutter SDK (Alpha)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter-sdk-docs/install">Install Realm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/flutter-sdk-docs/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/flutter-sdk-docs/realm-database">Realm Database</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Realm Database</h1></header><p>Realm Database is a reactive, object-oriented, cross-platform, mobile
database:</p><ul><li><strong>Reactive</strong>: query the current state of data and subscribe to state
changes like the result of a query, or even changes to a single
object.</li><li><strong>Object-oriented</strong>: organizes data as objects, rather than rows,
documents, or columns.</li><li><strong>Cross-platform</strong>: use the same database on iOS, Android, Linux,
macOS, or Windows. Just define a schema for each SDK you use.</li><li><strong>Mobile</strong>: designed for the low-power, battery-sensitive, real-time
environment of a mobile device.</li></ul><p>Realm Database is an alternative to
<a href="https://www.sqlite.org/index.html" target="_blank" rel="noopener noreferrer">SQLite</a> and <a href="https://developer.apple.com/documentation/coredata" target="_blank" rel="noopener noreferrer">Core
Data</a>.</p><p>This page explains some of the implementation details and inner workings
of Realm Database. This page is for you if you are:</p><ul><li>a developer interested in learning more about Realm Database</li><li>comparing Realm Database with competing databases</li></ul><p>This explanation begins with a deep dive into database internals,
continues with a high-level introduction to some of the features of
Realm Database.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="database-internals">Database Internals<a class="hash-link" href="#database-internals" title="Direct link to heading">â€‹</a></h2><p>Realm Database uses a completely unique database engine, file format,
and design. This section describes some of the high-level details of
those choices.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="native-database-engine">Native Database Engine<a class="hash-link" href="#native-database-engine" title="Direct link to heading">â€‹</a></h3><p>Realm Database is an entire database written from scratch in C++,
instead of building on top of an underlying database engine like SQLite.
Realm Database&#x27;s underlying storage layer uses <a href="https://en.wikipedia.org/wiki/B%2B_tree" target="_blank" rel="noopener noreferrer">B+
trees</a> to organize objects. As
a result, Realm Database controls optimizations from the storage level
all the way up to the access level.</p><p>Realm Database stores data in <strong>realms</strong>: collections of heterogeneous
realm objects. You can think of each realm as a database. Each object in
a realm is equivalent to a row in a SQL database table or a MongoDB
document. Unlike SQL, realms do not separate different object types into
individual tables.</p><p>Realm Database stores objects as groups of property values. We call this
column-based storage. This means that queries or writes for individual
objects can be slower than row-based storage equivalents when unindexed,
but querying a single field across multiple objects or fetching multiple
objects can be much faster due to spatial locality and in-CPU vector
operations.</p><p>Realm Database uses a
<a href="https://en.wikipedia.org/wiki/Zero-copy" target="_blank" rel="noopener noreferrer">zero-copy</a> design to make
queries faster than an ORM, and often faster than raw SQLite.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="realm-files">Realm Files<a class="hash-link" href="#realm-files" title="Direct link to heading">â€‹</a></h3><p>Realm Database persists data in files saved on device storage. The
database uses several kinds of file:</p><ul><li><strong>realm files</strong>, suffixed with &quot;realm&quot;, e.g. <code>default.realm</code>:
contain object data.</li><li><strong>lock files</strong>, suffixed with &quot;lock&quot;, e.g. <code>default.realm.lock</code>:
keep track of which versions of data in a realm are actively in use.
This prevents realm from reclaiming storage space that is still used
by a client application.</li><li><strong>note files</strong>, suffixed with &quot;note&quot;, e.g. <code>default.realm.note</code>:
enable inter-thread and inter-process notifications.</li><li><strong>management files</strong>, suffixed with &quot;management&quot;, e.g.
<code>default.realm.management</code>: internal state management.</li></ul><p>Realm files contain object data with the following data structures:
Groups, Tables, Cluster Trees, and Clusters. Realm Database organizes
these data structures into a tree structure with the following form:</p><ul><li>The top level, known as a Group, stores object metadata, a
transaction log, and a collection of Tables.</li><li>Each class in the realm schema corresponds to a Table within the
top-level Group.</li><li>Each Table contains a Cluster Tree, an implementation of a B+ tree.</li><li>Leaves on the Cluster Tree are called Clusters. Each contains a
range of objects sorted by key value.</li><li>Clusters store objects as collections of columns.</li><li>Each column contains data for a single property for multiple
instances of a given object. Columns are arrays of data with
uniformly sized values.</li><li>Columns store data in one of the following sizes: 1, 2, 4, 8, 16,
32, or 64 bits. Each column uses one value size, determined by the
largest value.</li></ul><p>Since pointers refer to memory addresses, objects written to persistent
files cannot store references as pointers. Instead, realm files refer to
data using the offset from the beginning of the file. We call this a
ref. As Realm Database uses memory mapping to read and write data,
database operations translate these refs from offsets to memory pointers
when navigating database structures.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="copy-on-write-the-secret-sauce-of-data-versioning">Copy-on-Write: The Secret Sauce of Data Versioning<a class="hash-link" href="#copy-on-write-the-secret-sauce-of-data-versioning" title="Direct link to heading">â€‹</a></h3><p>Realm Database uses a technique called <strong>copy-on-write</strong>, which copies
data to a new location on disk for every write operation instead of
overwriting older data on disk. Once the new copy of data is fully
written, the database updates existing references to that data. Older
data is only garbage collected when it is no longer referenced or
actively in use by a client application.</p><p>Because of copy-on-write, older copies of data remain valid, since all
of the references in those copies still point to other valid data. Realm
Database leverages this fact to offer multiple versions of data
simultaneously to different threads in client applications. Most
applications tie data refreshes to the repaint cycle of the looper
thread that controls the UI, since data only needs to refresh as often
as the UI does. Longer-running procedures on background threads, such as
large write operations, can work with a single version of data for a
longer period of time before committing their changes.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="memory-mapping">Memory Mapping<a class="hash-link" href="#memory-mapping" title="Direct link to heading">â€‹</a></h3><p>Writes use <a href="https://en.wikipedia.org/wiki/Memory-mapped_file" target="_blank" rel="noopener noreferrer">memory
mapping</a> to avoid
copying data back and forth from memory to storage. Accessors and
mutators read and write to disk via memory mapping. As a result, object
data is never stored on the stack or heap of your app. By default, data
is memory-mapped as read-only to prevent accidental writes.</p><p>Realm Database uses operating system level paging, trusting each
operating system to implement memory mapping and persistence better than
a single library could on its own.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="compaction">Compaction<a class="hash-link" href="#compaction" title="Direct link to heading">â€‹</a></h3><p>Realm Database automatically reuses free space that is no longer needed
after database writes. However, realm files never shrink automatically,
even if the amount of data stored in your realm decreases significantly.
Compact your realm to optimize storage space and decrease file size if
possible.</p><p>You should compact your realms occasionally to keep them at an optimal
size. You can do this manually, or by configuring your realms to compact
on launch. However, Realm Database reclaims unused space for future
writes, so compaction is only an optimization to conserve space
on-device.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="acid-compliance">ACID Compliance<a class="hash-link" href="#acid-compliance" title="Direct link to heading">â€‹</a></h3><p>Realm Database guarantees that transactions are
<a href="https://en.wikipedia.org/wiki/ACID" target="_blank" rel="noopener noreferrer">ACID</a> compliant.
This means that all committed write operations are
guaranteed to be valid and that clients don&#x27;t see transient states in
the event of a system crash. Realm Database complies with ACID with the
following design choices:</p><ul><li><a href="https://en.wikipedia.org/wiki/Atomicity_(database_systems)" target="_blank" rel="noopener noreferrer">Atomicity</a>:
groups operations in transactions and rolls back all operations in a
transaction if any of them fail.</li><li><a href="https://en.wikipedia.org/wiki/Consistency_(database_systems)" target="_blank" rel="noopener noreferrer">Consistency</a>:
avoids data corruption by validating changes against the schema. If
the result of any write operation is not valid, Realm cancels and
rolls back the entire transaction.</li><li><a href="https://en.wikipedia.org/wiki/Isolation_(database_systems)" target="_blank" rel="noopener noreferrer">Isolation</a>:
allows only one writer at a time. This ensures thread safety between
transactions.</li><li><a href="https://en.wikipedia.org/wiki/Durability_(database_systems)" target="_blank" rel="noopener noreferrer">Durability</a>:
writes to disk immediately when a transaction is committed. In the
event of an app crash, for example, changes are not lost or
corrupted.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="features">Features<a class="hash-link" href="#features" title="Direct link to heading">â€‹</a></h2><p>Realm Database supports many popular database features.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="queries">Queries<a class="hash-link" href="#queries" title="Direct link to heading">â€‹</a></h3><p>You can query Realm Database using platform-native queries or a raw
query language that works across platforms.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="indexes">Indexes<a class="hash-link" href="#indexes" title="Direct link to heading">â€‹</a></h3><p>Indexes are implemented as trees containing values of a given property
instead of a unique internal object key. This means that indexes only
support one column, and thus only one property, at a time.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="schemas">Schemas<a class="hash-link" href="#schemas" title="Direct link to heading">â€‹</a></h3><p>Every realm object has a schema. That schema is defined via a native
object in your SDK&#x27;s language. Object schemas can include embedded lists
and relations between object instances.</p><p>Each realm uses a versioned schema. When that schema changes, you must
define a migration to move object data between schema versions. Additive
schema changes happen automatically, but your SDK may require you to
increase the local schema version to begin using the updated schema in
your app. Destructive changes require a migration function. See your
SDK&#x27;s documentation for more information on migrations.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/realm-database.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/flutter-sdk-docs/quick-start"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quick Start</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#database-internals" class="table-of-contents__link toc-highlight">Database Internals</a><ul><li><a href="#native-database-engine" class="table-of-contents__link toc-highlight">Native Database Engine</a></li><li><a href="#realm-files" class="table-of-contents__link toc-highlight">Realm Files</a></li><li><a href="#copy-on-write-the-secret-sauce-of-data-versioning" class="table-of-contents__link toc-highlight">Copy-on-Write: The Secret Sauce of Data Versioning</a></li><li><a href="#memory-mapping" class="table-of-contents__link toc-highlight">Memory Mapping</a></li><li><a href="#compaction" class="table-of-contents__link toc-highlight">Compaction</a></li><li><a href="#acid-compliance" class="table-of-contents__link toc-highlight">ACID Compliance</a></li></ul></li><li><a href="#features" class="table-of-contents__link toc-highlight">Features</a><ul><li><a href="#queries" class="table-of-contents__link toc-highlight">Queries</a></li><li><a href="#indexes" class="table-of-contents__link toc-highlight">Indexes</a></li><li><a href="#schemas" class="table-of-contents__link toc-highlight">Schemas</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/flutter-sdk-docs/">Flutter SDK Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/realm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/realm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/mongodben/flutter-sdk-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/flutter-sdk-docs/assets/js/runtime~main.35287061.js"></script>
<script src="/flutter-sdk-docs/assets/js/main.202f0466.js"></script>
</body>
</html>